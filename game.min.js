"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Drawing=function t(){_classCallCheck(this,t)};function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}var LinesAnimation=function(){function n(t,e,r){_classCallCheck(this,n),this.ctx=t,this.loaded=!1,this.isPlaying=!1,this.drawings=[],this.layers=[],this.currentFrame=0,this.currentFrameCounter=0,this.lps=e||12,this.fps=e||12,this.lineInterval=1e3/this.lps,this.intervalRatio=1,this.mixedColors=r||!0,this.rndr={off:{x:0,y:0},speed:{x:0,y:0}},this._state="default",this.states={default:{start:0,end:0}},this.over={},this.override=!0}return _createClass(n,[{key:"overrideProperty",value:function(t,e){this.over[t]=e,this.override=!0}},{key:"cancelOverride",value:function(){this.over={},this.override=!1}},{key:"update",value:function(){this.isPlaying&&(this.currentFrame<=this.currentState.end&&(this.currentFrameCounter+=this.intervalRatio,this.currentFrame=Math.floor(this.currentFrameCounter),this.onUpdate&&this.onUpdate()),this.frame4>=this.currentState.end+1&&(this.frame=this.currentState.start,this.onPlayedState&&this.onPlayedState()),this.onUpdate&&this.onUpdate())}},{key:"draw",value:function(t,e){this.mixedColors||this.ctx.beginPath();for(var r=0,n=this.layers.length;r<n;r++){var o=this.layers[r],i=this.drawings[o.d];if(this.currentFrame>=o.f.s&&this.currentFrame<=o.f.e){for(var s in this.rndr.s=0,this.rndr.e=i.length,o)this.rndr[s]=o[s];if(t&&(this.rndr.x+=t),e&&(this.rndr.y+=e),o.t)for(var a=0;a<o.t.length;a++){var c=o.t[a];c.sf<=this.currentFrame&&c.ef>=this.currentFrame&&(this.rndr[c.prop]=Cool.map(this.currentFrame,c.sf,c.ef,c.sv,c.ev),"s"!=c.prop&&"e"!=c.prop||(this.rndr[c.prop]=Math.round(this.rndr[c.prop])))}if(this.override)for(var u in this.over)this.rndr[u]=this.over[u];0<this.rndr.w?(this.rndr.off.x=Cool.random(0,this.rndr.w),this.rndr.off.y=Cool.random(0,this.rndr.w),this.rndr.speed.x=Cool.random(-this.rndr.v,this.rndr.v),this.rndr.speed.y=Cool.random(-this.rndr.v,this.rndr.v)):(this.rndr.off.x=0,this.rndr.off.y=0,this.rndr.speed.x=0,this.rndr.speed.y=0),this.mixedColors&&this.ctx.beginPath();for(var l=this.rndr.s;l<this.rndr.e-1;l++){var f=i[l],h=i[l+1],p=new Cool.Vector(h.x,h.y);p.subtract(f),p.divide(this.rndr.n),this.ctx.moveTo(this.rndr.x+f.x+Cool.random(-this.rndr.r,this.rndr.r)+this.rndr.off.x,this.rndr.y+f.y+Cool.random(-this.rndr.r,this.rndr.r)+this.rndr.off.y);for(var y=0;y<this.rndr.n;y++){var d=new Cool.Vector(f.x+p.x*y,f.y+p.y*y);if(this.ctx.lineTo(this.rndr.x+d.x+p.x+Cool.random(-this.rndr.r,this.rndr.r)+this.rndr.off.x,this.rndr.y+d.y+p.y+Cool.random(-this.rndr.r,this.rndr.r)+this.rndr.off.y),(0==y||this.rndr.ws)&&0<this.rndr.w)for(var _ in this.rndr.off)this.rndr.off[_]+=this.rndr.speed[_],(this.rndr.off[_]>=this.rndr.w||this.rndr.off[_]<=-this.rndr.w)&&(this.rndr.speed[_]*=-1)}this.ctx.strokeStyle!=this.rndr.c&&this.mixedColors&&(this.ctx.strokeStyle=this.rndr.c)}this.mixedColors&&this.ctx.stroke()}}this.mixedColors||this.ctx.stroke(),this.onDraw&&this.onDraw()}},{key:"load",value:function(t,e){var r=this;fetch(t).then(function(t){return t.json()}).then(function(t){r.loadData(t,e)}).catch(function(t){console.error(t)})}},{key:"loadJSON",value:function(t,e){this.loadData(t,e)}},{key:"loadData",value:function(t,e){this.loaded=!0;for(var r=0;r<t.d.length;r++){var n=t.d[r],o=void 0;if(n){o=[];for(var i=0;i<n.length;i++){var s=n[i];s?o.push({x:s[0],y:s[1]}):o.push("end")}}else o=null;this.drawings[r]=o}for(var a in this.layers=t.l,t.s)this.states[a]=t.s[a];this.states.default&&(this.states.default.end=this.endFrame),this.intervalRatio=this.lineInterval/(1e3/t.fps),t.mc&&(this.mixedColors=t.mc),this.width=t.w,this.height=t.h,e&&e(t),this.onLoad&&this.onLoad()}},{key:"setOnLoad",value:function(t){this.loaded?t():this.onLoad=t}},{key:"fps",set:function(t){this._fps=+t,this.intervalRatio=this.lineInterval/(1e3/t)},get:function(){return this._fps}},{key:"lps",set:function(t){this._lps=+t,this.lineInterval=1e3/t,this.intervalRatio=this.lineInterval/(1e3/this.fps)},get:function(){return this._lps}},{key:"frame",set:function(t){this.currentFrame=this.currentFrameCounter=+t,this.states.default&&this.states.default.end!=this.endFrame&&(this.states.default.end=this.endFrame)}},{key:"frame4",get:function(){return+this.currentFrameCounter.toFixed(4)}},{key:"endFrame",get:function(){return 0<this.layers.length?Math.max.apply(Math,this.layers.map(function(t){return t.f.e})):0}},{key:"currentState",get:function(){return this.states[this.state]}},{key:"state",set:function(t){this._state!=t&&this.states[t]&&(this._state=t,this.currentState&&(this.frame=this.currentState.start))},get:function(){return this._state}}]),n}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Range=function t(){_classCallCheck(this,t)};function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}function _get(t,e,r){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=_superPropBase(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(r):o.value}})(t,e,r||t)}function _superPropBase(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(n){return function(){var t,e=_getPrototypeOf(n);if(_isNativeReflectConstruct()){var r=_getPrototypeOf(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return _possibleConstructorReturn(this,t)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Button=function(){_inherits(o,UI);var n=_createSuper(o);function o(t,e){var r;return _classCallCheck(this,o),(r=n.call(this,t,e)).mouseOver=!1,r.waitToGoOut=!1,r.clickStarted=!1,t.onOver&&(r.onOver=t.onOver),t.onOut&&(r.onOut=t.onOut),t.onDown&&(r.onDown=t.onDown),t.onClick&&(r.onClick=t.onClick),r}return _createClass(o,[{key:"over",value:function(t,e){var r=_get(_getPrototypeOf(o.prototype),"over",this).call(this,t,e);return r&&(this.animation.state="over"),r}},{key:"out",value:function(t,e){var r=_get(_getPrototypeOf(o.prototype),"out",this).call(this,t,e);return r&&(this.animation.state="idle"),r}},{key:"down",value:function(t,e){var r=_get(_getPrototypeOf(o.prototype),"down",this).call(this,t,e);return r&&(this.animation.state="active"),r}},{key:"up",value:function(t,e){var r=_get(_getPrototypeOf(o.prototype),"up",this).call(this,t,e);return r&&(this.animation.state="idle"),r}}]),o}();function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(n){return function(){var t,e=_getPrototypeOf(n);if(_isNativeReflectConstruct()){var r=_getPrototypeOf(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return _possibleConstructorReturn(this,t)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Entity=function(){_inherits(i,Sprite);var o=_createSuper(i);function i(t,e,r){var n;return _classCallCheck(this,i),(n=o.call(this,t.x,t.y)).debug=r,n.origin=new Cool.Vector(t.x,t.y),n.center=t.center||!0,n}return _createClass(i,[{key:"update",value:function(t){this.position=this.origin.copy().add(t.copy())}},{key:"setPosition",value:function(t,e){this.origin=new Cool.Vector(t,e)}}]),i}(),Events={init:function(t){var e,r=!1;t.addEventListener("click",function(t){t.preventDefault(),"function"==typeof mouseClicked&&mouseClicked(t.offsetX,t.offsetY)},!1),t.addEventListener("mousedown",function(t){t.preventDefault(),"function"==typeof mouseDown&&mouseDown(t.offsetX,t.offsetY,t.which,t.shiftKey),"function"==typeof startDrag&&(e=startDrag(t.offsetX,t.offsetY))&&(r=!0)},!1),t.addEventListener("mouseup",function(t){t.preventDefault(),"function"==typeof mouseUp&&mouseUp(t.offsetX,t.offsetY,t.which),r=r&&!1},!1),t.addEventListener("mousemove",function(t){"function"==typeof mouseMoved&&mouseMoved(t.offsetX,t.offsetY,t.which),r&&drag(t.offsetX,t.offsetY,e)},!1),document.addEventListener("keydown",function(t){"function"==typeof keyDown&&"INPUT"!=t.target.tagName&&keyDown(Cool.keys[t.which])}),document.addEventListener("keyup",function(t){"function"==typeof keyUp&&"INPUT"!=t.target.tagName&&keyUp(Cool.keys[t.which])}),window.addEventListener("resize",function(t){"function"==typeof sizeCanvas&&sizeCanvas()},!1)}};function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}var Game=function(){function e(t){_classCallCheck(this,e),this.canvas=document.getElementById(t.canvas||"lines"),this.width=t.width,this.height=t.height,this.lps=t.lps,this.mixedColors=t.mixedColors||!1,this.debug=t.debug||!1,this.lineInterval=1e3/t.lps,this.updateTime=performance.now(),this.updateInterval=1e3/60,this.drawTime=performance.now(),this.clearBg=!0,this.bounds={top:0,bottom:0,left:0,right:0},this.scenes=new SceneManager(t.scenes,Scene),this.data={},this.anims={},this.canvas.getContext&&(this.ctx=this.canvas.getContext("2d"),this.dpr=t.checkRetina&&window.devicePixelRatio||1,this.canvas.width=this.width*this.dpr,this.canvas.height=this.height*this.dpr,this.ctx.scale(this.dpr,this.dpr),this.canvas.style.zoom=1/this.dpr,t.lineColor&&(this.ctx.strokeStyle=t.lineColor),t.scale&&this.ctx.scale(t.scale,t.scale),t.stats&&(this.stats=new Stats(this.ctx,["FPS","draw"])),this.ctx.miterLimit=1)}function t(){return r.apply(this,arguments)}var r,n,o;function i(){return n.apply(this,arguments)}function s(){return o.apply(this,arguments)}return _createClass(e,[{key:"load",value:function(e){var s=this;this.assetsLoaded={};function t(i){var t=e[i];fetch(t).then(function(t){if(t.ok)return t.url.includes("csv")?t.text():t.json();throw new Error("Network response was not ok.")}).then(function(t){if(s.data[i]={},s.anims[i]={},s.assetsLoaded[i]={},"object"==_typeof(t))for(var e in s.data[i].entries=t)s.assetsLoaded[i][e]=!1,s.loadJSON(i,e,t[e].src);else{var r=CSVToArray(t,",").splice(1);s.data[i].entries=r;for(var n=0;n<r.length;n++){var o=r[n][0];s.assetsLoaded[i][o]=!1,s.loadJSON(i,o,"drawings/".concat(i,"/").concat(o,".json"))}}}).catch(function(t){console.error(t),s.assetsLoaded[i]=!0})}var n=Object.keys(e).length;for(var r in e)t(r);var o=setInterval(function(){var t=Object.keys(s.assetsLoaded).length==n;for(var e in s.assetsLoaded)for(var r in s.assetsLoaded[e])s.assetsLoaded[e][r]||(t=!1);t&&(clearInterval(o),s.start())},1e3/60)}},{key:"loadJSON",value:function(e,r,t){var n=this;fetch(t).then(function(t){return t.json()}).then(function(t){n.anims[e][r]=new GameAnim,n.anims[e][r].loadData(t,function(){n.assetsLoaded[e][r]=!0})})}},{key:"start",value:(o=function(){var t=this;"function"==typeof start&&start(),"function"==typeof update&&requestAnimFrame(function(){t.update()}),"function"==typeof draw&&requestAnimFrame(function(){t.draw()}),void 0!==Events&&Events.init(this.canvas)},s.toString=function(){return o.toString()},s)},{key:"draw",value:(n=function(){var t=this,e=performance.now();e>=this.drawTime+this.lineInterval&&(this.clearBg&&this.ctx.clearRect(0,0,this.width*this.dpr,this.height*this.dpr),draw(),this.stats&&(this.stats.draw(),this.stats.update("draw",e,this.drawTime)),this.drawTime=e),requestAnimFrame(function(){t.draw()})},i.toString=function(){return n.toString()},i)},{key:"update",value:(r=function(){var t=this,e=performance.now();e>this.updateTime+this.updateInterval&&(update(),this.stats&&this.stats.update("FPS",e,this.updateTime),this.updateTime=e),requestAnimFrame(function(){t.update()})},t.toString=function(){return r.toString()},t)},{key:"addLettering",value:function(t){for(var e="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ.,:?-+'&$;\"!",r=0;r<e.length;r++)t.createNewState(e[r],r,r)}},{key:"setBounds",value:function(t,e){this.bounds[t]=e}}]),e}();function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(n){return function(){var t,e=_getPrototypeOf(n);if(_isNativeReflectConstruct()){var r=_getPrototypeOf(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return _possibleConstructorReturn(this,t)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var GameAnim=function(){_inherits(i,LinesAnimation);var o=_createSuper(i);function i(t,e,r){var n;return _classCallCheck(this,i),(n=o.call(this,gme.ctx,gme.lps,gme.mixedColors)).debug=r,n.loop=!0,n.randomFrames=!1,n}return _createClass(i,[{key:"update",value:function(){if(this.isPlaying&&this.currentFrame<=this.currentState.end){if(this.currentFrameCounter+=this.intervalRatio,this.randomFrames&&this.currentFrame!=Math.floor(this.currentFrameCounter))for(var t=this.currentFrame;t==this.currentFrame;)this.frame=Cool.randomInt(this.currentState.start,this.currentState.end);this.currentFrame=Math.floor(this.currentFrameCounter),this.onUpdate&&this.onUpdate()}this.frame4>=this.currentState.end+1&&(this.loop?this.frame=this.currentState.start:this.frame=this.currentState.end,this.onPlayedOnce&&(this.onPlayedOnce(),this.onPlayedOnce=void 0),this.onPlayedState&&this.onPlayedState())}},{key:"createNewState",value:function(t,e,r){this.states[t]||(this.states[t]={start:e,end:r}),this.state=t}},{key:"playOnce",value:function(t){this.isPlaying||(this.isPlaying=!0),this.frame=this.currentState.start,this.onPlayedOnce=t}},{key:"stop",value:function(){this.isPlaying=!1}},{key:"start",value:function(){this.isPlaying=!0}},{key:"state",set:function(t){this._state!=t&&this.states[t]&&(this._state=t,this.currentState&&(this.frame=this.currentState.start),this.isPlaying||"default"==t||(this.isPlaying=!0))},get:function(){return this._state}}]),i}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}var Manager=function(){function n(t,e){_classCallCheck(this,n);for(var r=0;r<t.length;r++)this[t[r]]=new e;this._current=t[0]}return _createClass(n,[{key:"current",set:function(t){this._current=t},get:function(){return this[this._current]}}]),n}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}var Scene=function(){function t(){_classCallCheck(this,t),this.displaySprites=new SpriteCollection,this.updateSprites=new SpriteCollection,this.uiSprites=new SpriteCollection}return _createClass(t,[{key:"add",value:function(t){this.displaySprites.add(t),this.updateSprites.add(t),this.uiSprites.add(t)}},{key:"remove",value:function(t,e){for(var r=e?[e]:["display","update","ui"],n=0;n<r.length;n++){var o=this["".concat(r[n],"Sprites")].indexOf(t);0<=o&&this["".concat(r[n],"Sprites")].splice(o,1)}}},{key:"addSprite",value:function(t){this.displaySprites.add(t),this.updateSprites.add(t)}},{key:"addUI",value:function(t){this.displaySprites.add(t),this.uiSprites.add(t)}},{key:"addToDisplay",value:function(t){this.displaySprites.add(t)}},{key:"addToUpdate",value:function(t){this.updateSprites.add(t)}},{key:"addToUI",value:function(t){this.uiSprites.add(t)}},{key:"display",value:function(){this.displaySprites.all(function(t){t.display()})}},{key:"update",value:function(){this.updateSprites.all(function(t){t.update()})}},{key:"mouseMoved",value:function(e,r){this.uiSprites.all(function(t){t.over(e,r),t.out(e,r)})}},{key:"mouseDown",value:function(e,r){this.uiSprites.all(function(t){t.down(e,r)})}},{key:"mouseUp",value:function(e,r){this.uiSprites.all(function(t){t.up(e,r)})}}]),t}();function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(n){return function(){var t,e=_getPrototypeOf(n);if(_isNativeReflectConstruct()){var r=_getPrototypeOf(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return _possibleConstructorReturn(this,t)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var SceneManager=function(){_inherits(e,Manager);var t=_createSuper(e);function e(){return _classCallCheck(this,e),t.apply(this,arguments)}return _createClass(e,[{key:"add",value:function(t,e,r){"string"==typeof e&&(e=[e]);for(var n=0;n<e.length;n++)"display"==r?this[e[n]].addToDisplay(t):"ui"==r?this[e[n]].addUI(t):this[e[n]].add(t)}}]),e}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}var Sprite=function(){function o(t,e,r,n){_classCallCheck(this,o),this.position=new Cool.Vector(t,e),this.width=r,this.height=n,this.debug=!1,this.debugColor="#00ffbb",this.collider={position:new Cool.Vector(0,0),width:this.width,height:this.height},this.isActive=!0,this.center=!1,this.mouseOver=!1,this.waitToGoOut=!1,this.clickStarted=!1}return _createClass(o,[{key:"resetSize",value:function(){this.width=void 0,this.height=void 0}},{key:"addAnimation",value:function(t){this.animation=t,this.width=this.collider.width=this.animation.width,this.height=this.collider.height=this.animation.height}},{key:"fit",value:function(t){this.width>t&&this.scale(t/this.width)}},{key:"setCollider",value:function(t,e,r,n){this.collider.position.x=t,this.collider.position.y=e,this.collider.width=r,this.collider.height=n}},{key:"scale",value:function(t){this.width*=t,this.height*=t,this.collider.width*=t,this.collider.height*=t,this.animation.widthRatio*=t,this.animation.heightRatio*=t}},{key:"update",value:function(){this.isActive&&(0!=this.jumpAmount&&(this.velocity.y+=this.jumpAmount,this.jumpAmount=0),0<this.wiggleAmount&&(this.velocity.x+=getRandom(-this.wiggleAmount,this.wiggleAmount)),this.position.add(this.velocity),this.bounceAmount.zero()||(this.velocity.add(this.bouncAmount),this.bounceAmount=new Cool.Vector(0,0)))}},{key:"drawDebug",value:function(){gme.ctx.lineWidth=1,gme.ctx.beginPath(),gme.ctx.rect(this.xy.x+this.collider.position.x,this.xy.y+this.collider.position.y,this.collider.width,this.collider.height);var t=gme.ctx.strokeStyle;gme.ctx.strokeStyle=this.debugColor,gme.ctx.stroke(),gme.ctx.strokeStyle=t}},{key:"getCenter",value:function(){return this.center?{x:this.position.x-(this.center?this.width/2:0),y:this.position.y-(this.center?this.height/2:0)}:this.position}},{key:"display",value:function(t){this.isActive&&(this.isOnScreen()||t)&&(this.debug&&this.drawDebug(),this.animation&&this.animation.loaded&&(this.animation.draw(this.xy.x,this.xy.y),this.animation.update())),this.displayFunc&&this.displayFunc()}},{key:"isOnScreen",value:function(){return 0<this.xy.x+this.width&&0<this.xy.y+this.height&&this.xy.x<gme.width&&this.xy.y<gme.height}},{key:"tap",value:function(t,e){return t>this.xy.x+this.collider.position.x&&t<this.xy.x+this.collider.position.x+this.collider.width&&e>this.xy.y+this.collider.position.y&&e<this.xy.y+this.collider.position.y+this.collider.height}},{key:"jump",value:function(t){this.jumpAmount+=Math.min(-t/25,10)}},{key:"collide",value:function(t,e){if(this.isActive&&t.isActive){if(this.xy.x+this.collider.position.x<t.xy.x+t.collider.position.x+t.collider.width&&this.xy.x+this.collider.position.x+this.collider.width>t.xy.x+t.collider.position.x&&this.xy.y+this.collider.position.y<t.xy.y+t.collider.position.y+t.collider.height&&this.xy.y+this.collider.position.y+this.collider.height>t.xy.y+t.collider.position.y)return e&&e(this),!0;if(this.bounce){var r=new Cool.Vector(this.xy.x,this.xy.y);if(r.add(this.velocity),r.x<t.position.x+t.width&&r.x+this.width>t.position.x&&r.y<t.position.y+t.size.y&&r.y+this.height>t.position.y){var n=this.position.x+this.width-t.position.y,o=this.position.y+this.height-t.position.y;return Math.abs(n)<Math.abs(o)?this.position.x=t.position.x-this.width:(this.position.y=t.position.y-this.height,this.bounceAmount.add(new Cool.Vector(0,o/2))),e&&e(this),!0}return!1}return!1}return!1}},{key:"outside",value:function(t){var e=this.position.copy(),r=this.collider.position.copy();e.add(r),e.add(this.velocity);var n=this.collider.size.copy();return e.x<t.position.x+t.collider.position.x||e.x+n.x>t.position.x+t.collider.position.x+t.collider.width||e.y<t.position.y+t.collider.position.y||e.y+n.y>t.position.y+t.collider.position.y+t.collider.height}},{key:"reset",value:function(t,e,r,n){this.position.x=Cool.randomInt(t,e-this.width),this.position.y=Cool.randomInt(r,n)}},{key:"over",value:function(t,e){return!(!this.isActive||!this.tap(t,e)||this.mouseOver||this.waitToGoOut)&&(this.mouseOver=!0,this.onOver&&this.onOver(),!0)}},{key:"out",value:function(t,e){return!(!this.isActive||this.tap(t,e)||!this.mouseOver&&!this.waitToGoOut)&&(this.clickStarted=!1,this.waitToGoOut=!1,this.mouseOver=!1,this.onOut&&this.onOut(),!0)}},{key:"down",value:function(t,e){return!(!this.isActive||!this.tap(t,e))&&(this.clickStarted=!0,this.waitToGoOut=!0,this.onDown&&this.onDown(),!0)}},{key:"up",value:function(t,e){return!!(this.isActive&&this.tap(t,e)&&this.clickStarted)&&(this.mouseOver=!1,this.onUp&&this.onUp(),this.onClick&&this.onClick(),this.func&&func(),!0)}},{key:"xy",get:function(){return this.center?{x:this.position.x-(this.center?this.width/2:0),y:this.position.y-(this.center?this.height/2:0)}:this.position}}]),o}();function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _iterableToArray(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}var SpriteCollection=function(){function e(t){_classCallCheck(this,e),this.sprites=t?_toConsumableArray(t):[]}return _createClass(e,[{key:"sprite",value:function(t){return this.sprites[t]}},{key:"remove",value:function(t){this.sprites.splice(this.sprites.indexOf(t),1)}},{key:"add",value:function(t){this.sprites.push(t)}},{key:"all",value:function(t){for(var e=0;e<this.sprites.length;e++)t(this.sprites[e],e)}},{key:"display",value:function(){this.all(function(t){t.display()})}},{key:"length",get:function(){return this.sprites.length}}]),e}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}var Stats=function(){function n(t,e){var r=this;_classCallCheck(this,n),this.ctx=t,this.ctx.font="lighter 11px sans-serif",this.stats={},e.forEach(function(t){r.stats[t]=[]})}return _createClass(n,[{key:"create",value:function(t){this.stats[t]=[]}},{key:"update",value:function(t,e,r){this.stats[t].push(1e3/(e-r)),20<this.stats[t].length&&this.stats[t].shift()}},{key:"draw",value:function(){this.ctx.fillStyle="rgba(0,0,0,0.75)",this.ctx.fillRect(window.innerWidth-65,0,50,40),this.ctx.font="lighter 11px sans-serif",this.ctx.fillStyle="rgba(100,255,200)";var t=window.innerWidth-60,e=15;for(var r in this.stats){var n=this.stats[r],o="".concat(r," ").concat(Math.round(n.reduce(function(t,e){return t+e},0)/n.length));this.ctx.fillText(o,t,e),e+=20}}}]),n}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}var Text=function(){function i(t,e,r,n,o){_classCallCheck(this,i),this.x=Math.round(t),this.y=Math.round(e),this.lead=35,this.track=18,this.msg=r,this.wrap=n,this.isActive=!0,this.letters=o,this.breaks=[],this.setBreaks(),this.count=0,this.end=0,this.hover=!1,this.clickStarted=!1}return _createClass(i,[{key:"setPosition",value:function(t,e){this.x=t,this.y=e}},{key:"setMsg",value:function(t){this.msg=t,this.setBreaks()}},{key:"setBreaks",value:function(){var t=!1,e=0,r=!1;this.breaks=[];for(var n=1;n<this.msg.length;n++)r=!1,this.msg[n].match(/[\n\r]/g)&&!r?(this.breaks.push(n),e=n%this.wrap,t=!1):n%this.wrap!=e||t?" "==this.msg[n]&&t&&(this.breaks.push(n),e=n%this.wrap,r=!(t=!1)):" "==this.msg[n]?(this.breaks.push(n),r=!0):t=!0}},{key:"display",value:function(t,e,r,n){if(this.isActive){for(var o=t?this.count:this.msg.length,i=e?this.end:0,s=r||this.x,a=n||this.y,c=i;c<o;c++){var u=this.msg[c];" "==u||"_"==u?s+=this.track:"\n"==u||"\r"==u||(this.letters.state=u,this.letters.draw(s,a),s+=this.track),-1!=this.breaks.indexOf(c)&&(a+=this.lead,s=r||this.x)}if(this.count>=this.msg.length?this.end++:this.count++,e){if(this.end>=this.msg.length)return this.end=0,!(this.count=0)}else if(5<=this.end)return this.end=0,!(this.count=0)}}}]),i}();function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}function _get(t,e,r){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=_superPropBase(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(r):o.value}})(t,e,r||t)}function _superPropBase(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(n){return function(){var t,e=_getPrototypeOf(n);if(_isNativeReflectConstruct()){var r=_getPrototypeOf(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return _possibleConstructorReturn(this,t)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var TextButton=function(){_inherits(a,UI);var s=_createSuper(a);function a(t,e,r,n,o){var i;return _classCallCheck(this,a),(i=s.call(this,{x:t,y:e})).center=!1,i.text=new Text(i.position.x,i.position.y,r,n,o),i.setCollider(),i}return _createClass(a,[{key:"setMsg",value:function(t){this.text.setMsg(t),this.text.wrap=t.length,this.setCollider()}},{key:"setCollider",value:function(){this.width=this.collider.width=(this.text.wrap<this.text.msg.length?this.text.wrap:this.text.msg.length)*this.text.track,this.height=this.collider.height=(this.text.breaks.length+1)*this.text.letters.height}},{key:"display",value:function(){_get(_getPrototypeOf(a.prototype),"display",this).call(this),this.isActive&&this.text.display()}},{key:"setPosition",value:function(t,e){this.position.x=t,this.position.y=e,this.text.setPosition(t,e)}}]),a}();function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _iterableToArray(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}var Texture=function(){function r(t,e){_classCallCheck(this,r),this.locations=t.locations||[],this.frame=t.frame||"index",this.debug=e,this.center=t.center||!1,this.offset=new Cool.Vector(0,0),t.animation&&(this.animation=t.animation)}return _createClass(r,[{key:"addLocation",value:function(t,e,r){this.animation.createNewState("f-".concat(t),t,t);var n=new Cool.Vector(e,r);n.i=t,this.locations.push(n)}},{key:"addLocations",value:function(t){var e;(e=this.locations).push.apply(e,_toConsumableArray(t));for(var r=0;r<this.locations.length;r++)if("index"==this.frame)this.locations[r].i=r,this.animation.createNewState("f-".concat(r),r,r);else if("random"==this.frame)this.animation.randomFrames=!0;else if("randomIndex"==this.frame){var n=Cool.randomInt(0,this.animation.endFrame);this.locations[r].i=n,this.animation.createNewState("f-".concat(n),n,n)}}},{key:"display",value:function(){for(var t=0;t<this.locations.length;t++){var e=this.locations[t].x+this.offset.x,r=this.locations[t].y+this.offset.y;this.center&&(e-=this.animation.width/2,r-=this.animation.height/2),0<e+this.animation.width&&e<gme.width&&0<r+this.animation.height&&r<gme.height&&(this.locations[t].i&&(this.animation.state="f-".concat(this.locations[t].i)),this.animation.draw(e,r))}}},{key:"update",value:function(t){this.offset=t.copy()}}]),r}();function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}function _get(t,e,r){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=_superPropBase(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(r):o.value}})(t,e,r||t)}function _superPropBase(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(n){return function(){var t,e=_getPrototypeOf(n);if(_isNativeReflectConstruct()){var r=_getPrototypeOf(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return _possibleConstructorReturn(this,t)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Toggle=function(){_inherits(o,Button);var n=_createSuper(o);function o(t,e){var r;return _classCallCheck(this,o),(r=n.call(this,t,e)).toggled=!1,r}return _createClass(o,[{key:"toggle",value:function(t){this.toggled=t?"on"==t:!this.toggled,this.animation.state=this.toggled?"selected":"idle",this.func&&this.func(),this.waitToGoOut=!1,this.mouseOver=!1,this.clickStarted=!1}},{key:"out",value:function(t,e){_get(_getPrototypeOf(o.prototype),"out",this).call(this,t,e),this.animation.state=this.toggled?"selected":"idle"}},{key:"up",value:function(t,e){_get(_getPrototypeOf(o.prototype),"up",this).call(this),this.tap(t,e)&&this.clickStarted&&this.toggle()}}]),o}();function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(n){return function(){var t,e=_getPrototypeOf(n);if(_isNativeReflectConstruct()){var r=_getPrototypeOf(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return _possibleConstructorReturn(this,t)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var UI=function(){_inherits(s,Sprite);var i=_createSuper(s);function s(t,e){var r;_classCallCheck(this,s);var n=t.x,o=t.y;return n%1!=0&&(n=gme.width*n),n<0&&(n=gme.width+n),o%1!=0&&(o=gme.height*o),o<0&&(o=gme.height+o),(r=i.call(this,n,o)).debug=e,r.center=!0,t.hidden&&(r.isActive=!1),t.json&&r.addJSON(t.json),t.animation&&r.addAnimation(t.animation),t.states&&(r.animation.states=t.states,r.animation.state="idle"),r.scenes=t.scenes,t.func&&(r.func=window[t.func]),r}return s}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}var Area=function(){function i(t,e,r,n,o){_classCallCheck(this,i),this.x=Math.round(t),this.y=Math.round(e),this.w=Math.max(Math.round(r),1),this.h=Math.max(Math.round(n),1),this.c=o}return _createClass(i,[{key:"isInside",value:function(t,e){return t>=this.x&&t<this.x+this.w&&e>=this.y&&e<this.y+this.h}}]),i}();function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(n){return function(){var t,e=_getPrototypeOf(n);if(_isNativeReflectConstruct()){var r=_getPrototypeOf(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return _possibleConstructorReturn(this,t)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Node=function(){_inherits(s,Area);var i=_createSuper(s);function s(t,e,r,n){var o;return _classCallCheck(this,s),(o=i.call(this,t,e,r,n,Math.floor(random(255)))).paths=[],o.walls=[],o}return _createClass(s,[{key:"split",value:function(t){if(this.a||this.b)return!1;var e=Math.random()>this.w/(this.w+this.h);if(t>(e?this.h:this.w))return!1;var r=(e?this.h:this.w)-t;if(r<t)return!1;var n=Math.floor(random(t,r));return e?(this.a=new s(this.x,this.y,this.w,n),this.b=new s(this.x,this.y+n,this.w,this.h-n)):(this.a=new s(this.x,this.y,n,this.h),this.b=new s(this.x+n,this.y,this.w-n,this.h)),!0}},{key:"createRooms",value:function(){if(this.a||this.b)this.a&&this.a.createRooms(),this.b&&this.b.createRooms(),this.a&&this.b&&this.createPath(this.a.getRoom(),this.b.getRoom());else{var t=Math.floor(random(3,this.w-2)),e=Math.floor(random(3,this.h-2)),r=Math.floor(random(1,this.w-t-1)),n=Math.floor(random(1,this.h-e-1));this.room=new Room(r+this.x,n+this.y,t,e,"plum")}}},{key:"createWalls",value:function(){if(this.paths.length){var t=[];this.a&&(t=t.concat(this.a.getRooms())),this.b&&(t=t.concat(this.b.getRooms()));for(var e=this.x;e<this.x+this.w;e++)for(var r=this.y;r<this.y+this.h;r++){for(var n=!1,o=0;o<t.length;o++)t[o].isInside(e,r)&&(n=!0);for(var i=0;i<this.paths.length;i++)this.paths[i].isInside(e,r)&&(n=!0);n||this.walls.push(new Wall(e,r))}}else this.a&&this.a.createWalls(),this.b&&this.b.createWalls()}},{key:"getRooms",value:function(){return this.room?[this.room]:(this.a&&(t=this.a.getRooms()),this.b&&(e=this.b.getRooms()),t||e?t?e?t.concat(e):[e]:[t]:null);var t,e}},{key:"getRoom",value:function(){return this.room?this.room:(this.a&&(t=this.a.getRoom()),this.b&&(e=this.b.getRoom()),t||e?!e||t&&.5<random(1)?t:e:null);var t,e}},{key:"createPath",value:function(t,e){var r={x:Math.floor(random(t.x+1,t.x+t.w-2)),y:Math.floor(random(t.y+1,t.y+t.h-2))},n={x:Math.floor(random(e.x+1,e.x+e.w-2)),y:Math.floor(random(e.y+1,e.y+e.h-2))},o=n.x-r.x,i=n.y-r.y;o<0?i<0?.5<random(1)?(this.paths.push(new Path(n.x,r.y,Math.abs(o)+1,1,"gold")),this.paths.push(new Path(n.x,n.y,1,Math.abs(i)+1,"gold"))):(this.paths.push(new Path(n.x,n.y,Math.abs(o)+1,1,"gold")),this.paths.push(new Path(r.x,n.y,1,Math.abs(i)+1,"gold"))):0<i?.5<random(1)?(this.paths.push(new Path(n.x,r.y,Math.abs(o)+1,1,"gold")),this.paths.push(new Path(n.x,r.y,1,Math.abs(i)+1,"gold"))):(this.paths.push(new Path(n.x,n.y,Math.abs(o)+1,1,"gold")),this.paths.push(new Path(r.x,r.y,1,Math.abs(i),"gold"))):this.paths.push(new Path(n.x,n.y,Math.abs(o)+1,1,"gold")):0<o?i<0?.5<random(1)?(this.paths.push(new Path(r.x,n.y,Math.abs(o)+1,1,"gold")),this.paths.push(new Path(r.x,n.y,1,Math.abs(i)+1,"gold"))):(this.paths.push(new Path(r.x,r.y,Math.abs(o)+1,1,"gold")),this.paths.push(new Path(n.x,n.y,1,Math.abs(i)+1,"gold"))):0<i?.5<random(1)?(this.paths.push(new Path(r.x,r.y,Math.abs(o)+1,1,"gold")),this.paths.push(new Path(n.x,r.y,1,Math.abs(i)+1,"gold"))):(this.paths.push(new Path(r.x,n.y,Math.abs(o)+1,1,"gold")),this.paths.push(new Path(r.x,r.y,1,Math.abs(i)+1,"gold"))):this.paths.push(new Path(r.x,r.y,Math.abs(o)+1,1,"gold")):i<0?this.paths.push(new Path(n.x,n.y,1,Math.abs(i)+1,"gold")):this.paths.push(new Path(r.x,r.y,1,Math.abs(i)+1,"gold"))}},{key:"display",value:function(){"undefined"!=typeof p5&&(textSize(14),fill("blue"),textAlign(LEFT,TOP),text("".concat(this.x,",").concat(this.y),this.x*cell.w,this.y*cell.h)),this.room&&this.room.display(),this.a&&this.a.display(),this.b&&this.b.display();for(var t=0;t<this.paths.length;t++)this.paths[t].display();for(var e=0;e<this.walls.length;e++)this.walls[e].display()}}]),s}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}var Map=function(){function o(t,e,r,n){_classCallCheck(this,o),this.cols=t,this.rows=e,this.minNodeSize=r,this.maxNodeSize=n,this.nodes=[]}return _createClass(o,[{key:"build",value:function(t){this.walls=[],this.nodes.push(new Node(t.w,t.h,this.cols-2*t.w,this.rows-2*t.h)),console.group("load map"),console.time("nodes");for(var e=!0;e;){e=!1;for(var r=0;r<this.nodes.length;r++){var n=this.nodes[r];n.a||n.b||(n.w>this.maxNodeSize&&n.h>this.maxNodeSize||.5<random(1))&&n.split(this.minNodeSize)&&(this.nodes.push(n.a),this.nodes.push(n.b),e=!0)}}console.timeEnd("nodes"),console.time("rooms"),this.nodes[0].createRooms(),console.timeEnd("rooms"),console.time("walls");for(var o=0;o<this.cols;o++)for(var i=0;i<this.rows;i++){for(var s=!1,a=0;a<this.nodes.length;a++){this.nodes[a].room&&this.nodes[a].room.isInside(o,i)&&(s=!0);for(var c=0;c<this.nodes[a].paths.length;c++)this.nodes[a].paths[c].isInside(o,i)&&(s=!0)}s||this.walls.push(new Wall(o*cell.w,i*cell.h,"green"))}console.timeEnd("walls"),console.groupEnd()}}]),o}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}var Cursor=function(){function e(t){_classCallCheck(this,e),this.states=t,this.elem=document.getElementById("cursor"),this.x=0,this.y=0,this.isDown=!1}return _createClass(e,[{key:"down",value:function(){this.isDown=!0}},{key:"up",value:function(){this.isDown=!1}},{key:"state",set:function(t){this._state!=t&&(this._state=t,this.elem.src=this.states[t])},get:function(){return this._state}}]),e}();function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(n){return function(){var t,e=_getPrototypeOf(n);if(_isNativeReflectConstruct()){var r=_getPrototypeOf(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return _possibleConstructorReturn(this,t)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var HellButton=function(){_inherits(i,Button);var o=_createSuper(i);function i(){var t;_classCallCheck(this,i);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return t=o.call.apply(o,[this].concat(r)),Object.assign(_assertThisInitialized(t),buttonMixin),t}return i}();function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(n){return function(){var t,e=_getPrototypeOf(n);if(_isNativeReflectConstruct()){var r=_getPrototypeOf(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return _possibleConstructorReturn(this,t)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var HellGame=function(){_inherits(i,Game);var o=_createSuper(i);function i(){var t;_classCallCheck(this,i);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=o.call.apply(o,[this].concat(r))).lvl=0,t}return _createClass(i,[{key:"scene",set:function(t){if(t!=this.scenes._current){switch(this.scenes.current=t,ui.cursor.state="interact",t){case"map":ui.cursor.state="walk";break;case"loading":ui.message.x=leftAlign,ui.cursor.state="loading";break;case"message":ui.message.x=leftAlign;break;case"inventory":ui.message.x=centerAlign}ui.arrow.isActive=!1}}},{key:"currentScene",get:function(){return this.scenes.current}},{key:"currentSceneName",get:function(){return this.scenes._current}},{key:"lvlName",get:function(){return 0==this.lvl?"Purgatory":"Ring of Hell ".concat(this.lvl)}}]),i}();function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(n){return function(){var t,e=_getPrototypeOf(n);if(_isNativeReflectConstruct()){var r=_getPrototypeOf(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return _possibleConstructorReturn(this,t)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var HellItem=function(){_inherits(a,Entity);var s=_createSuper(a);function a(t,e,r,n,o){var i;return _classCallCheck(this,a),(i=s.call(this,{x:t,y:e})).addAnimation(r),i.type=o,i.name=n[0],i.health=+n[1],i.morality=+n[2],i.hunger=+n[3],i.speed=+n[4],i.hungerRate=+n[5],i.quote=n[7],i.consumeString,"food"==o?i.consumeString="Eat":"scripture"==o&&(i.consumeString="Read"),i}return a}();function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}function _get(t,e,r){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=_superPropBase(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(r):o.value}})(t,e,r||t)}function _superPropBase(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _createSuper(n){return function(){var t,e=_getPrototypeOf(n);if(_isNativeReflectConstruct()){var r=_getPrototypeOf(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return _possibleConstructorReturn(this,t)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _wrapNativeSuper(t){var r="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(t){if(null===t||!_isNativeFunction(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(t))return r.get(t);r.set(t,e)}function e(){return _construct(t,arguments,_getPrototypeOf(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(e,t)})(t)}function _construct(t,e,r){return(_construct=_isNativeReflectConstruct()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var o=new(Function.bind.apply(t,n));return r&&_setPrototypeOf(o,r.prototype),o}).apply(null,arguments)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function _isNativeFunction(t){return-1!==Function.toString.call(t).indexOf("[native code]")}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var HellMap=function(){_inherits(i,_wrapNativeSuper(Map));var o=_createSuper(i);function i(){var t;_classCallCheck(this,i);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return t=o.call.apply(o,[this].concat(r)),gme.scenes.map.add(_assertThisInitialized(t)),Object.assign(_assertThisInitialized(t),itemMixin),t}return _createClass(i,[{key:"build",value:function(t){var e=this;_get(_getPrototypeOf(i.prototype),"build",this).call(this,{w:Math.ceil(gme.width/2/cell.w),h:Math.ceil(gme.height/2/cell.h)}),this.roomCount=0,this.nodes.forEach(function(t){t.room&&e.roomCount++}),this.items=new SpriteCollection,this.addItems("food"),this.addItems("scripture"),t&&t()}},{key:"prob",value:function(t){return t=t.replace(/p(?![a-z])/g,Cool.map(gme.lvl,0,28,0,1)),Function("return "+t)().clamp(0,1)}},{key:"addItems",value:function(t){for(var e=random(1,this.roomCount),r=[],n=[],o=0;o<gme.data[t].entries.length;o++){var i=this.prob(gme.data[t].entries[o][6]);if(1==i)r.push(o);else if(0<i)for(var s=0;s<100*i;s++)n.push(o)}for(;r.length<e;){var a=Cool.random(n);r.includes(a)||r.push(a)}for(0;0<r.length;){var c=Cool.random(this.nodes.filter(function(t){return t.room})),u=r.pop(),l=gme.data[t].entries[u],f=c.room.getCell(),h=new MapItem(f.x*cell.w+Cool.random(-cell.w/4,cell.w/4),f.y*cell.h+Cool.random(-cell.h/4,cell.h/4),gme.anims[t][l[0]],l,t);this.items.add(h)}}},{key:"add",value:function(t){this.items.add(t)}},{key:"remove",value:function(t){this.items.remove(t)}},{key:"display",value:function(){this.nodes[0].display();for(var t=0;t<this.walls.length;t++)this.walls[t].display();this.items.display()}},{key:"update",value:function(){for(var e=new Cool.Vector(-player.x+gme.width/2,-player.y+gme.height/2),t=0;t<this.nodes.length;t++){var r=this.nodes[t];r.room&&r.room.update(e);for(var n=0;n<r.paths.length;n++)r.paths[n].update(e)}for(var o=0;o<this.walls.length;o++)this.walls[o].update(e);for(var i=!1,s=0;s<map.walls.length;s++){map.walls[s].collide(player)&&(i=!0)}i&&player.back(),this.items.all(function(t){t.update(e)})}}]),i}();function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}function _get(t,e,r){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=_superPropBase(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(r):o.value}})(t,e,r||t)}function _superPropBase(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _createSuper(n){return function(){var t,e=_getPrototypeOf(n);if(_isNativeReflectConstruct()){var r=_getPrototypeOf(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return _possibleConstructorReturn(this,t)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _wrapNativeSuper(t){var r="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(t){if(null===t||!_isNativeFunction(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(t))return r.get(t);r.set(t,e)}function e(){return _construct(t,arguments,_getPrototypeOf(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(e,t)})(t)}function _construct(t,e,r){return(_construct=_isNativeReflectConstruct()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var o=new(Function.bind.apply(t,n));return r&&_setPrototypeOf(o,r.prototype),o}).apply(null,arguments)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function _isNativeFunction(t){return-1!==Function.toString.call(t).indexOf("[native code]")}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var HellMessage=function(){_inherits(a,_wrapNativeSuper(Text));var s=_createSuper(a);function a(t,e,r,n,o){var i;return _classCallCheck(this,a),(i=s.call(this,t,e,r,n,o)).list=[],i.continue=new HellTextButton(i.x,i.y,"Click Here To Explore Purgatory",gme.anims.lettering.messages),gme.scenes.add(_assertThisInitialized(i),["message","loading","inventory","win"],"display"),gme.scenes.add(i.continue,["inventory","message","win"],"ui"),i.continue.onClick=function(){0==i.list.length?(i.set(""),player.died?loadNextMap():i.next?i.next():gme.scene="map",i.next=void 0):(i.set(i.list.shift()),i.continue.check())},i}return _createClass(a,[{key:"add",value:function(t){for(var e=!1,r=4*this.wrap,n=0,o=0;o<t.length;o++)o==n+r||e?t[o].match(/[\n\r\s]/g)?(this.list.push(t.substring(n,o)),e=!1,n=o+1):e=!0:n+r>t.length&&(this.list.push(t.substring(n,t.length)),o=t.length);this.msg||this.set(this.list.shift())}},{key:"set",value:function(t){if(_get(_getPrototypeOf(a.prototype),"setMsg",this).call(this,t),t){this.isActive=!0;var e=t.match(/[\n\r]/g),r=this.y+35*(this.breaks.length+2+(e?e.length:0));this.continue.setPosition(this.x,r),this.continue.isActive=!0}else this.active=!1,this.continue.isActive=!1}},{key:"display",value:function(){_get(_getPrototypeOf(a.prototype),"display",this).call(this)}}]),a}();function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(n){return function(){var t,e=_getPrototypeOf(n);if(_isNativeReflectConstruct()){var r=_getPrototypeOf(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return _possibleConstructorReturn(this,t)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var HellTextButton=function(){_inherits(c,TextButton);var a=_createSuper(c);function c(t,e,r,n,o,i){var s;return _classCallCheck(this,c),(s=a.call(this,t,e,r,r.length,n)).cursorState=o||"interact",i&&(s.onClick=i),s}return _createClass(c,[{key:"onOver",value:function(){ui.cursor.state=this.cursorState,ui.arrow.isActive=!0,ui.arrow.position.x=this.position.x+this.width,ui.arrow.position.y=this.position.y}},{key:"onOut",value:function(){ui.cursor.state="map"==gme.currentSceneName?"walk":"interact",ui.arrow.isActive=!1}},{key:"onDown",value:function(){ui.cursor.state="click"}},{key:"onUp",value:function(){ui.cursor.state="map"==gme.currentSceneName?"walk":"interact",ui.arrow.isActive=!1}},{key:"check",value:function(){this.tap(ui.cursor.x,ui.cursor.y)&&(ui.arrow.isActive=!0)}}]),c}();function _construct(t,e,r){return(_construct=_isNativeReflectConstruct()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var o=new(Function.bind.apply(t,n));return r&&_setPrototypeOf(o,r.prototype),o}).apply(null,arguments)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _iterableToArray(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}var Inventory=function(){function e(){_classCallCheck(this,e),this.size=3,this.maxSize=9,this.x=64,this.y=inventoryY,this.w=128,this.h=128,gme.scenes.inventory.addUI(this),Object.assign(this,itemMixin),this.label=new Text(3,140,"Inventory",9,gme.anims.lettering.metrics),this.items=new SpriteCollection,this.labels=[];for(var t=0;t<this.maxSize;t++)this.labels[t]=new Text(this.x+this.w*t-this.w/2,this.y+Math.floor(t/3)*this.h-this.h/2,""+t,1,gme.anims.lettering.metrics)}return _createClass(e,[{key:"add",value:function(t,e){var r=this;return gme.scene="inventory",this.items.length<this.size?(this.items.add(_construct(PackItem,_toConsumableArray(t))),ui.message.set("You picked up the ".concat(e,".")),this.items.all(function(t,e){t.position.x=r.x+r.w*e,t.position.y=r.y+Math.floor(e/3)*r.h}),!0):(gme.scene="message",ui.message.set("Your pack is full."),!1)}},{key:"remove",value:function(t){this.items.remove(t)}},{key:"display",value:function(){this.label.display();for(var t=0;t<this.size;t++)this.labels[t].display();this.items.display()}}]),e}();function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}function _get(t,e,r){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=_superPropBase(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(r):o.value}})(t,e,r||t)}function _superPropBase(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(n){return function(){var t,e=_getPrototypeOf(n);if(_isNativeReflectConstruct()){var r=_getPrototypeOf(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return _possibleConstructorReturn(this,t)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var MapItem=function(){_inherits(i,HellItem);var o=_createSuper(i);function i(){for(var t,e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return _classCallCheck(this,i),(t=o.call.apply(o,[this].concat(r))).pickup=new HellTextButton(t.position.x+t.width/2,t.position.y,"Pick up ".concat(t.name),gme.anims.lettering.messages),t.pickup.isActive=!1,t.pickup.onClick=function(){inventory.add(r,t.name)&&(ui.arrow.isActive=!1,map.remove(_assertThisInitialized(t)))},t.consume=new HellTextButton(t.position.x+t.width/2,t.position.y+35,"".concat(t.consumeString," ").concat(t.name),gme.anims.lettering.messages,"food"==t.type?"eat":"interact"),t.consume.isActive=!1,t.consume.onClick=function(){map.remove(_assertThisInitialized(t)),player.consume(_assertThisInitialized(t),t.type)},t.ui=new SpriteCollection([t.pickup,t.consume]),t}return _createClass(i,[{key:"display",value:function(){_get(_getPrototypeOf(i.prototype),"display",this).call(this),this.ui.display()}},{key:"update",value:function(t){_get(_getPrototypeOf(i.prototype),"update",this).call(this,t),this.collide(player)?(this.pickup.setPosition(this.position.x+this.width/2,this.position.y-35),this.consume.setPosition(this.position.x+this.width/2,this.position.y),this.pickup.isActive=!0,this.consume.isActive=!0):(this.pickup.isActive=!1,this.consume.isActive=!1)}},{key:"over",value:function(e,r){this.ui.all(function(t){return t.over(e,r)})}},{key:"out",value:function(e,r){this.ui.all(function(t){return t.out(e,r)})}},{key:"down",value:function(e,r){this.ui.all(function(t){return t.down(e,r)})}},{key:"up",value:function(e,r){this.ui.all(function(t){return t.up(e,r)})}}]),i}();function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _construct(t,e,r){return(_construct=_isNativeReflectConstruct()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var o=new(Function.bind.apply(t,n));return r&&_setPrototypeOf(o,r.prototype),o}).apply(null,arguments)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}function _get(t,e,r){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=_superPropBase(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(r):o.value}})(t,e,r||t)}function _superPropBase(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(n){return function(){var t,e=_getPrototypeOf(n);if(_isNativeReflectConstruct()){var r=_getPrototypeOf(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return _possibleConstructorReturn(this,t)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var PackItem=function(){_inherits(i,HellItem);var o=_createSuper(i);function i(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return _classCallCheck(this,i),(e=o.call.apply(o,[this].concat(r))).displayInventory=!1,Object.assign(_assertThisInitialized(e),buttonMixin),e.consume=new HellTextButton(centerAlign,inventoryY-35,"".concat(e.consumeString," ").concat(e.name),gme.anims.lettering.messages,"food"==e.type?"eat":"interact"),e.consume.isActive=!1,e.consume.onClick=function(){player.consume(_assertThisInitialized(e),e.type),inventory.remove(_assertThisInitialized(e))},e.drop=new HellTextButton(centerAlign,inventoryY,"Drop ".concat(e.name),gme.anims.lettering.messages),e.drop.isActive=!1,e.drop.onClick=function(){inventory.remove(_assertThisInitialized(e));var t=_construct(MapItem,r);t.setPosition(player.x,player.y),map.add(t),gme.scene="map"},e.ui=new SpriteCollection([e.consume,e.drop]),e}return _createClass(i,[{key:"display",value:function(){_get(_getPrototypeOf(i.prototype),"display",this).call(this),this.ui.display()}},{key:"onClick",value:function(){var t=!this.displayInventory;inventory.items.all(function(t){return t.toggleInventoryDisplay(!1)}),this.toggleInventoryDisplay(t)}},{key:"toggleInventoryDisplay",value:function(t){var e=this;this.displayInventory=void 0===t?!this.displayInventoryUI:t,this.ui.all(function(t){t.isActive=e.displayInventory})}},{key:"over",value:function(e,r){_get(_getPrototypeOf(i.prototype),"over",this).call(this,e,r),this.ui.all(function(t){return t.over(e,r)})}},{key:"out",value:function(e,r){_get(_getPrototypeOf(i.prototype),"out",this).call(this,e,r),this.ui.all(function(t){return t.out(e,r)})}},{key:"down",value:function(e,r){_get(_getPrototypeOf(i.prototype),"down",this).call(this,e,r),this.ui.all(function(t){return t.down(e,r)})}},{key:"up",value:function(e,r){_get(_getPrototypeOf(i.prototype),"up",this).call(this,e,r),this.ui.all(function(t){return t.up(e,r)})}}]),i}();function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(n){return function(){var t,e=_getPrototypeOf(n);if(_isNativeReflectConstruct()){var r=_getPrototypeOf(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return _possibleConstructorReturn(this,t)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Path=function(){_inherits(e,Room);var t=_createSuper(e);function e(){return _classCallCheck(this,e),t.apply(this,arguments)}return _createClass(e,[{key:"addTextureAnimation",value:function(){this.texture.animation=gme.anims.textures.grass}}]),e}();function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(n){return function(){var t,e=_getPrototypeOf(n);if(_isNativeReflectConstruct()){var r=_getPrototypeOf(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return _possibleConstructorReturn(this,t)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Player=function(){_inherits(s,Sprite);var i=_createSuper(s);function s(t,e,r,n){var o;return _classCallCheck(this,s),(o=i.call(this,Math.round(e),Math.round(r))).x=Math.round(e),o.y=Math.round(r),o.prevXY={x:o.x,y:o.y},o.center=!0,o.debug=n||!1,o.speed=new Cool.Vector(8,8),o.addAnimation(t),o.animation.state="idle",o.setCollider(25,6,78,90),o.input={right:!1,up:!1,left:!1,down:!1},o.target=new Cool.Vector(0,0),o.metricCount=0,o.died=!1,o.health=100,o.morality=0,o.hunger=0,o.hungerRate=.5,o.hungerLevel=0,o}return _createClass(s,[{key:"inputKey",value:function(t,e){this.input[t]=e}},{key:"setTarget",value:function(t,e){this.target.x=t,this.target.y=e,this.hunger+=this.hungerRate}},{key:"update",value:function(){Math.abs(this.target.x)<this.speed.x&&(this.target.x=0),Math.abs(this.target.y)<this.speed.y&&(this.target.y=0),this.prevXY={x:this.x,y:this.y};var t=this.animation.state.includes("idle")?this.animation.state:Cool.random(["idle"]);(this.input.up||this.target.y<0)&&(this.target.y<0&&(this.target.y+=this.speed.y),this.y>gme.bounds.top&&(this.y-=this.speed.y),t="right"),(this.input.down||0<this.target.y)&&(0<this.target.y&&(this.target.y-=this.speed.y),this.y<gme.bounds.bottom&&(this.y+=this.speed.y),t="left"),(this.input.right||0<this.target.x)&&(0<this.target.x&&(this.target.x-=this.speed.x),this.x<gme.bounds.right&&(this.x+=this.speed.x),t="right"),(this.input.left||this.target.x<0)&&(this.target.x<0&&(this.target.x+=this.speed.x),this.x>gme.bounds.left&&(this.x-=this.speed.x),t="left"),this.animation.state=t,this.died||(200==this.metricCount&&(this.checkHunger(),this.metricCount=0),this.metricCount++)}},{key:"back",value:function(){this.target.x=0,this.target.y=0,this.x=this.prevXY.x,this.y=this.prevXY.y}},{key:"spawn",value:function(){var t=Cool.random(map.nodes.filter(function(t){return t.room})).room.getCell();player.x=t.x*cell.w,player.y=t.y*cell.h}},{key:"reborn",value:function(){this.health=100,this.metricCount=0,ui.metrics.health.update(),ui.metrics.level.update(),this.died=!1,this.speed.x=8,this.speed.y=8,this.target.x=0,this.target.y=0}},{key:"checkMorality",value:function(){0==this.morality?(ui.message.add("You hath been morally neutral."),ui.message.add("You will remain in ".concat(0==gme.lvl?"purgatory":"this ring of hell","."))):0<this.morality?gme.lvl<=0?(gme.lvl,gme.scene="win",ui.message.set("Play again"),ui.message.next=loadMap):(--gme.lvl,ui.message.add("You hath acted morally."),ui.message.add("You will move up to a previous ring of hell.")):(ui.message.add("You are a sinner."),ui.message.add("You will descend further into hell."),gme.lvl+=1)}},{key:"checkHealth",value:function(){ui.metrics.health.update(),this.health<=0&&(ui.message.add("You hath died."),this.died=!0,this.checkMorality())}},{key:"checkHunger",value:function(){if(Math.floor(player.hunger/10)>this.hungerLevel)switch(this.hungerLevel=Math.floor(player.hunger/10),2<this.hungerLevel&&(--this.speed.x,--this.speed.y),gme.scene="message",this.hungerLevel){case 1:ui.message.set("You feel a slight pang of hunger.");break;case 2:ui.message.set("Was that sound your stomach?");break;case 3:ui.message.set("Your stomach growled.");break;case 4:ui.message.set("Your stomach is twisting in pain.");break;case 5:ui.message.set("You are starting to feel weak.");break;case 6:ui.message.set("You are beginning to feel light headed.");break;case 7:ui.message.set("Your body is desparate for food.");break;case 8:ui.message.set("You starved to death."),this.died=!0,this.checkMorality()}}},{key:"consume",value:function(t,e){switch(this.typeString,e){case"food":this.typeString="ate";break;case"scripture":this.typeString="read"}gme.scene="message",this.speed.x=8,this.speed.y=8,ui.message.set("You ".concat(this.typeString," the ").concat(t.name,".")),ui.message.add(t.quote),this.health=Math.min(100,this.health+t.health),0!=t.health&&ui.message.add("Your health hath ".concat(0<t.health?"increased":"decreased",".")),this.hunger=Math.max(0,this.hunger-t.hunger),0<t.hunger&&ui.message.add("Your hunger hath abated."),this.hungerRate=Math.max(.1,this.hungerRate+t.hungerRate),this.morality+=t.morality,0!=t.morality&&ui.message.add("You hath ".concat(0<t.morality?"acted morally":"sinned",".")),this.speed.x+=t.speed,this.speed.y+=t.speed,ui.metrics.morality.update(),this.checkHealth()}}]),s}();function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(n){return function(){var t,e=_getPrototypeOf(n);if(_isNativeReflectConstruct()){var r=_getPrototypeOf(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return _possibleConstructorReturn(this,t)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Room=function(){_inherits(c,Area);var a=_createSuper(c);function c(){var t;_classCallCheck(this,c);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];for(var o=[],i=(t=a.call.apply(a,[this].concat(r))).x;i<t.x+t.w;i++)for(var s=t.y;s<t.y+t.h;s++)o.push({x:i*cell.w,y:s*cell.h});return t.texture=new Texture({frame:"randomIndex",center:!0},!0),t.addTextureAnimation(),t.texture.addLocations(o),t.debug=!0,t.takenCells=[],t}return _createClass(c,[{key:"addTextureAnimation",value:function(){this.texture.animation=gme.anims.textures.dirt}},{key:"getCell",value:function(){for(var e=Cool.randomInt(this.x,this.x+this.w-1),r=Cool.randomInt(this.y,this.y+this.h-1),t=0;this.takenCells.filter(function(t){return t.x==e&&t.y==r}).length;)if(e=Cool.randomInt(this.x,this.x+this.w),r=Cool.randomInt(this.y,this.y+this.h),10<++t)return void loadMap();return this.takenCells.push({x:e,y:r}),{x:e,y:r}}},{key:"display",value:function(){if(this.texture.display(),this.debug){gme.ctx.globalAlpha=mapAlpha;gme.ctx.fillStyle=this.debug,gme.ctx.strokeStyle=this.debug,gme.ctx.fillRect(20*this.x,20*this.y,20*this.w,20*this.h),gme.ctx.fillStyle="white",gme.ctx.font="".concat(10,"px sans-serif"),gme.ctx.fillText("".concat(this.x,",").concat(this.y),20*this.x,20*this.y+10),gme.ctx.globalAlpha=1}}},{key:"update",value:function(t){this.texture.update(t)}}]),c}();function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}function _get(t,e,r){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=_superPropBase(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(r):o.value}})(t,e,r||t)}function _superPropBase(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _createSuper(n){return function(){var t,e=_getPrototypeOf(n);if(_isNativeReflectConstruct()){var r=_getPrototypeOf(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return _possibleConstructorReturn(this,t)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _wrapNativeSuper(t){var r="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(t){if(null===t||!_isNativeFunction(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(t))return r.get(t);r.set(t,e)}function e(){return _construct(t,arguments,_getPrototypeOf(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(e,t)})(t)}function _construct(t,e,r){return(_construct=_isNativeReflectConstruct()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var o=new(Function.bind.apply(t,n));return r&&_setPrototypeOf(o,r.prototype),o}).apply(null,arguments)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function _isNativeFunction(t){return-1!==Function.toString.call(t).indexOf("[native code]")}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var UIMetric=function(){_inherits(s,_wrapNativeSuper(Text));var i=_createSuper(s);function s(t,e,r){var n;_classCallCheck(this,s);var o=r();return(n=i.call(this,t,e,o,o.length,gme.anims.lettering.metrics)).callback=r,gme.scenes.add(_assertThisInitialized(n),["map","inventory","message"],"display"),n}return _createClass(s,[{key:"update",value:function(){_get(_getPrototypeOf(s.prototype),"setMsg",this).call(this,this.callback()),this.wrap=this.msg.length,this.setBreaks()}}]),s}();function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}function _get(t,e,r){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=_superPropBase(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(r):o.value}})(t,e,r||t)}function _superPropBase(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(n){return function(){var t,e=_getPrototypeOf(n);if(_isNativeReflectConstruct()){var r=_getPrototypeOf(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return _possibleConstructorReturn(this,t)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Wall=function(){_inherits(h,Sprite);var f=_createSuper(h);function h(t,e,r){var n;_classCallCheck(this,h),(n=f.call(this,t*cell.w,e*cell.h,cell.w,cell.h)).center=!0,n.origin=new Cool.Vector(t,e),n.texture=new Texture({frame:"index",center:!0,animation:gme.anims.textures.walls},!1);for(var o=[],i=2*gme.lvl,s=gme.lvl+Cool.random(5,10);i<s;i++)for(var a=1-(i-gme.lvl)/s,c=0;c<Math.floor(10*a);c++)o.push(i);for(var u=0,l=Cool.random(2,5);u<l;u++)n.texture.addLocation(Cool.random(o),t+Cool.random(-cell.w/3,cell.w/3),e+Cool.random(-cell.h/3,cell.h/3));return n}return _createClass(h,[{key:"display",value:function(){_get(_getPrototypeOf(h.prototype),"display",this).call(this),this.texture.display()}},{key:"update",value:function(t){this.position=this.origin.copy().add(t.copy()),this.texture.update(t)}}]),h}(),buttonMixin={onOver:function(){ui.cursor.state="interact"},onOut:function(){ui.cursor.state="map"==gme.currentSceneName?"walk":"interact"},onDown:function(){ui.cursor.state="click"},onUp:function(){ui.cursor.state="map"==gme.currentSceneName?"walk":"interact"}},itemMixin={over:function(e,r){this.items.all(function(t){return t.over(e,r)})},out:function(e,r){this.items.all(function(t){return t.out(e,r)})},down:function(e,r){this.items.all(function(t){return t.down(e,r)})},up:function(e,r){this.items.all(function(t){return t.up(e,r)})}};window.random=Cool.random;var player,inventory,ui,gme=new HellGame({width:window.innerWidth,height:window.innerHeight,lps:10,mixedColors:!0,checkRetina:!0,debug:!0,stats:!0,scenes:["map","inventory","message","loading","win"]});console.time("load data"),gme.load({ui:"data/ui.json",sprites:"data/sprites.json",textures:"data/textures.json",food:"data/food.csv",scripture:"data/scripture.csv",lettering:"data/lettering.json"});var map,god,wall,apple,cols=30,rows=30,minNodeSize=8,maxNodeSize=14,cell={w:256,h:256},grafWrap=28,leftAlign=6,centerAlign=416,inventoryY=260,welcomeMessage="Welcome to Infinite Hell. \nYou are in ".concat(gme.lvlName,". \nYou are morally neutral. \n\nYou must perform a moral act to find your way to Heaven. \n\nIf you sin, you will descend further into Hell."),mapAlpha=0;function start(){console.timeEnd("load data"),gme.addLettering(gme.anims.lettering.metrics),gme.addLettering(gme.anims.lettering.messages),gme.setBounds("top",gme.height/2),gme.setBounds("left",gme.width/2),gme.setBounds("right",cols*cell.w-gme.width/2),gme.setBounds("bottom",rows*cell.h-gme.height/2),map=new HellMap(cols,rows,minNodeSize,maxNodeSize),player=new Player(gme.anims.sprites.player,gme.width/2,gme.height/2),inventory=new Inventory,(god=new Sprite(256,gme.height/2)).center=!0,god.addAnimation(gme.anims.sprites.god),gme.scenes.add(god,"win","display"),(ui={metrics:{}}).metrics.level=new UIMetric(3,6,function(){return gme.lvlName}),ui.metrics.morality=new UIMetric(270,6,function(){return"Morality ".concat(player.morality)}),ui.metrics.health=new UIMetric(540,6,function(){return"Health ".concat(player.health)}),ui.cursor=new Cursor({walk:"css/walk.gif",interact:"css/pointer.gif",click:"css/click.gif",eat:"css/mouth.gif",loading:"css/loader.gif"}),ui.cursor.state="walk",ui.arrow=new Sprite(0,0),ui.arrow.addAnimation(gme.anims.ui.arrow),ui.arrow.isActive=!1,gme.scenes.add(ui.arrow,["map","inventory","message","win"],"display"),ui.inventoryOpen=new HellTextButton(750,6,"inventory",gme.anims.lettering.metrics,"interact",function(){gme.scene="inventory"}),gme.scenes.add(ui.inventoryOpen,["map"],"ui"),ui.inventoryExit=new HellTextButton(750,6,"exit",gme.anims.lettering.metrics,"interact",function(){gme.scene="map",ui.message.set("")}),gme.scenes.add(ui.inventoryExit,["inventory"],"ui"),ui.message=new HellMessage(6,102,"",grafWrap,gme.anims.lettering.messages),ui.message.debug=!0,ui.message.set(welcomeMessage),gme.scene="message",ui.message.next=loadNextMap}function loadNextMap(){ui.message.continue.setMsg("Continue"),gme.scene="loading",ui.message.set("Building ".concat(gme.lvlName," ...")),setTimeout(buildMap,100)}function buildMap(){console.time("map"),map.build(function(){ui.message.set(""),gme.scene="map",console.timeEnd("map"),player.died&&player.reborn(),player.spawn()})}function update(){player.update(),gme.scenes.current.update()}function draw(){gme.scenes.current.display(),player.display()}function sizeCanvas(){gme.width=window.innerWidth,gme.height=window.innerHeight,gme.canvas.width=window.innerWidth*gme.dpr,gme.canvas.height=window.innerHeight*gme.dpr,gme.ctx.scale(gme.dpr,gme.dpr),gme.canvas.style.zoom=1/gme.dpr,gme.ctx.miterLimit=1,gme.ctxStrokeColor=void 0,player.position.x=gme.width/2,player.position.y=gme.height/2}function keyDown(t){switch(t){case"a":case"left":player.inputKey("left",!0);break;case"w":case"up":player.inputKey("up",!0);break;case"d":case"right":player.inputKey("right",!0);break;case"s":case"down":player.inputKey("down",!0)}}function keyUp(t){switch(t){case"a":case"left":player.inputKey("left",!1);break;case"w":case"up":player.inputKey("up",!1);break;case"d":case"right":player.inputKey("right",!1);break;case"s":case"down":player.inputKey("down",!1)}}function mouseMoved(t,e){ui.cursor.x=t,ui.cursor.y=e,gme.scenes.current.mouseMoved(t,e)}function mouseDown(t,e){ui.cursor.down(),gme.scenes.current.mouseDown(t,e)}function mouseUp(t,e){ui.cursor.up(),gme.scenes.current.mouseUp(t,e)}document.addEventListener("keydown",function(t){187==t.which?mapAlpha=Math.min(1,mapAlpha+.5):189==t.which&&(mapAlpha=Math.max(0,mapAlpha-.5))}),document.addEventListener("mousedown",function(t){"walk"==ui.cursor.state&&player.setTarget(t.pageX-player.position.x,t.pageY-player.position.y)},!1),gme.canvas.addEventListener("mousemove",function(t){cursor.style.left="".concat(t.offsetX,"px"),cursor.style.top="".concat(t.offsetY,"px")},!1);